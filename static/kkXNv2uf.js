import{_ as O,r as s,h as z,f as M,a7 as $,m as _,M as D,c as R,a as n,b as l,w as o,G as W,o as B,d as c}from"#entry";import{V as P,e as U,a as j,d as q,b as F,c as H}from"./n-BQ7oG4.js";import{V as X}from"./J1C_d0ne.js";import{i as J,V}from"./29nWB00M.js";import{V as K}from"./DThhxZu_.js";import{V as y,e as Q,f as T}from"./8BdTRp8n.js";import{V as h}from"./BeJKJZ5z.js";import"./RpCd5kzp.js";import"./olVGSFH9.js";import"./Dd5_FK3M.js";import"./DWwmsQnu.js";import"./Beu9iL6A.js";import"./QJ6H-Z_T.js";const Y=`輔一甲
特教一
教博一
復碩一
高照原民專班一
科博一
數一甲
物一甲
生一
化一
光博一
統資碩一
理學位碩一
科技機電產攜專班一
人管博一
車輛碩一
AI碩士學程一
智車一
技職碩一
英一
國一甲
地一
美一
科英碩一
翻譯碩一
台文碩一
歷碩一
機電一
電機一
電機博一
電子一
資工一
工學位碩一
資管一
會一甲
企管一
財金一
運一
運碩一
運健碩一
公育一
特殊學籍班(大學部)
特殊學籍學士班
特殊學籍碩博班
核心通識
物碩博
光電碩博
大三、四體育
歷大學
語文課
產業學士班
產業碩士班
地碩博
電機碩博
機電碩博
台碩博
國碩博
科技碩博
數碩博
科碩博
教碩博
輔導碩博

`,Z={class:"d-flex justify-center"},ee={class:"d-flex"},te={class:"conditional-area d-flex align-center"},le={class:"d-flex flex-column ga-5"},ae={__name:"ClassConverter114",setup(oe){const g=s(new Map),i=s(""),d=s(""),E=s(null),C=s(null),x=s("系所簡稱"),b=["系所簡稱","系所全名","學院簡稱","學院全名","系辦助理","系辦助理分機","系辦助理Email","課務承辦人","課務承辦人分機","課務承辦人Email"],f=s(!1);let m=null,v=null;const{$curridataAPI:A}=z(),w=e=>{e.preventDefault();const t=e.clipboardData.getData("text");i.value=t.trim()},S=()=>{i.value="",d.value=""},N=async()=>{try{if(!navigator.clipboard){alert("你的瀏覽器不支援剪貼簿功能，請手動複製。");return}await navigator.clipboard.writeText(d.value),f.value=!0}catch(e){console.error("複製失敗:",e),alert("複製失敗，請手動複製。")}},k=async()=>{try{if(!navigator.clipboard){alert("你的瀏覽器不支援剪貼簿功能，請手動複製。");return}await navigator.clipboard.writeText(Y),f.value=!0}catch(e){console.error("複製失敗:",e),alert("複製失敗，請手動複製。")}};M(async()=>{try{const{data:a}=await A.get("/get_all_data");a.forEach(r=>{g.value.set(r.CLASS,r)}),console.log("資料已成功載入")}catch(a){console.error("載入資料失敗:",a)}const e=E.value?.$el.querySelector("textarea"),t=C.value?.$el.querySelector("textarea");if(e&&t){const a=p=>{p.target===e?t.scrollTop=e.scrollTop:p.target===t&&(e.scrollTop=t.scrollTop)};e.addEventListener("scroll",a),t.addEventListener("scroll",a);const r=()=>{t.style.height=`${e.offsetHeight}px`,t.style.width=`${e.offsetWidth}px`},u=()=>{e.style.height=`${t.offsetHeight}px`,e.style.width=`${t.offsetWidth}px`};m=new ResizeObserver(r),v=new ResizeObserver(u),m.observe(e),v.observe(t)}}),$(()=>{m&&m.disconnect(),v&&v.disconnect()});const I={系所全名:e=>e.DEPT,系所簡稱:e=>e.DEPT_S,學院全名:e=>e.COLLEGE,學院簡稱:e=>e.COLLEGE_S,系辦助理:e=>e.AGENT_NAME,系辦助理分機:e=>e.AGENT_EXT,系辦助理Email:e=>e.AGENT_EMAIL,課務承辦人:e=>e.CAGENT_NAME,課務承辦人分機:e=>e.CAGENT_EXT,課務承辦人Email:e=>e.CAGENT_EMAIL},L=_(()=>{if(!i.value||!g.value.size)return"";const e=i.value.split(`
`),t=I[x.value];return t?e.map(r=>{const u=r.trim(),p=g.value.get(u);return p?t(p):"查無資料"}).join(`
`):"無效選項"});D(L,e=>{d.value=e});const G=_(()=>b.reduce((r,u)=>r.length>u.length?r:u,"").length*10+80);return(e,t)=>(B(),R("div",Z,[n("div",null,[t[11]||(t[11]=n("h1",null,"班級簡稱轉換(114以後)",-1)),n("div",ee,[l(P,{class:"my-2 my-card-wrapper",variant:"tonal",color:"indigo"},{default:o(()=>[l(U,null,{default:o(()=>[l(j,null,{default:o(()=>[...t[4]||(t[4]=[c("使用教學",-1)])]),_:1}),l(q,null,{default:o(()=>[...t[5]||(t[5]=[c("輸入限制：班級簡稱",-1)])]),_:1})]),_:1}),l(F,null,{default:o(()=>[...t[6]||(t[6]=[n("ul",null,[n("li",null," 在左輸入框貼上從Excel複製的班級簡稱，右邊輸入框會自動產出結果。 "),n("li",null,"貼上後想看不同結果可選擇下拉選項"),n("li",null,"可將結果複製貼回Excel中使用。")],-1)])]),_:1}),l(H,null,{default:o(()=>[l(y,{color:"indigo-lighten-3 text-white",variant:"elevated",onClick:k},{default:o(()=>[t[7]||(t[7]=c(" 點我複製範例 ",-1)),l(V,{icon:"mdi-content-copy",end:""})]),_:1})]),_:1})]),_:1})]),n("div",te,[l(X,{modelValue:x.value,"onUpdate:modelValue":t[0]||(t[0]=a=>x.value=a),class:"function-selector mt-4 listitemheight",items:b,label:"功能選擇",style:W({maxWidth:`${G.value}px`}),density:"comfortable"},null,8,["modelValue","style"])]),l(J,{id:"mpage",class:"px-0"},{default:o(()=>[l(Q,{"no-gutters":"",class:"align-center"},{default:o(()=>[l(T,{cols:"auto"},{default:o(()=>[l(h,{ref_key:"inputRef",ref:E,modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=a=>i.value=a),class:"resizable-textarea text-right",label:"輸入框",onPaste:w},null,8,["modelValue"])]),_:1}),l(T,{cols:"auto",class:"px-2 pb-5"},{default:o(()=>[n("div",le,[l(y,{color:"green-lighten-3 text-grey-darken-4",onClick:N},{default:o(()=>[t[8]||(t[8]=c(" Copy ",-1)),l(V,{icon:"mdi-content-copy",end:""})]),_:1}),l(y,{color:"blue-lighten-3 text-grey-darken-4",onClick:S},{default:o(()=>[t[9]||(t[9]=c(" Clear ",-1)),l(V,{icon:"mdi-close-circle-outline",end:""})]),_:1})])]),_:1}),l(T,{cols:"auto"},{default:o(()=>[l(h,{ref_key:"outputRef",ref:C,modelValue:d.value,"onUpdate:modelValue":t[2]||(t[2]=a=>d.value=a),class:"resizable-textarea",label:"輸出框"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(K,{modelValue:f.value,"onUpdate:modelValue":t[3]||(t[3]=a=>f.value=a),timeout:2e3,color:"success",location:"bottom right"},{default:o(()=>[...t[10]||(t[10]=[c(" 已複製到剪貼簿 ",-1)])]),_:1},8,["modelValue"])])]))}},Ve=O(ae,[["__scopeId","data-v-50c8e231"]]);export{Ve as default};
