import{_ as k,h as U,r as d,f as h,c as $,b as a,w as s,F as A,o as D,d as u,t as T}from"#entry";import{V as z,b as g,d as L,a as S,c as I}from"./Bt-Lg9Yq.js";import{V as B}from"./Bs6P97i3.js";import{V as M}from"./BLqfoVb2.js";import{V as v}from"./C9RONKOs.js";import{V as N}from"./CXslL-Oe.js";import{V as R}from"./DKpZsHsa.js";import"./BVTHWD1S.js";import"./C8WRQOr-.js";import"./BvfaC3Sv.js";import"./olVGSFH9.js";import"./CsFBHHeY.js";import"./CcGyTVB8.js";import"./IZXj_S-L.js";import"./CeZwhVst.js";import"./C1UajEuD.js";import"./CG-H6YXY.js";import"./khdByflT.js";import"./D9ZmUaMT.js";import"./BFs1KdCe.js";import"./8YB82fyE.js";import"./BEHT4fO-.js";import"./CY2eiWj5.js";const _="/api/upload-save",E={__name:"Upload",setup(j){const{$curridataAPI:b}=U(),n=d(null),p=d(!1),f=d(!1),y=d(""),w=d("success"),c=d([]),i=d(null),m=d(!1);async function V(){m.value=!0,c.value=[],i.value=null;try{let e=(await b.get("/api/list-saves")).data.files||[];const l=e.filter(t=>t.includes("."));if(c.value=l,c.value.length===0)r("ä¼ºæœå™¨å­˜æª”ç›®éŒ„ä¸­æ²’æœ‰å¯ä¾›ä¸‹è¼‰çš„æª”æ¡ˆã€‚","info");else if(e.length!==l.length){const t=e.length-l.length;r(`å·²æˆåŠŸæŽ’é™¤ ${t} å€‹è³‡æ–™å¤¾ï¼Œåƒ…é¡¯ç¤ºæª”æ¡ˆã€‚`,"success")}else r(`âœ… æˆåŠŸè¼‰å…¥ ${c.value.length} å€‹æª”æ¡ˆã€‚`,"success")}catch(o){console.error("ç²å–æª”æ¡ˆåˆ—è¡¨å¤±æ•—:",o),r("âŒ ç„¡æ³•è¼‰å…¥å­˜æª”åˆ—è¡¨ã€‚","error")}finally{m.value=!1}}function C(){if(!i.value)return;const o=b.defaults.baseURL||window.location.origin,e=encodeURIComponent(i.value),l=`${o}/api/download-save/${e}`,t=document.createElement("a");t.href=l,t.setAttribute("download",i.value),document.body.appendChild(t),t.click(),document.body.removeChild(t),r(`ðŸ“¥ æ­£åœ¨ä¸‹è¼‰ï¼š${i.value} (ä¸‹è¼‰å°‡åœ¨ç€è¦½å™¨ä¸­é–‹å§‹)`,"info"),i.value=null}h(V);async function F(){if(!n.value){r("è«‹å…ˆé¸æ“‡ä¸€å€‹æª”æ¡ˆï¼","warning");return}p.value=!0;let o=null;if(Array.isArray(n.value)&&n.value.length>0?o=n.value[0]:n.value instanceof File&&(o=n.value),!o||!(o instanceof File)){r("æª”æ¡ˆç‰©ä»¶ç„¡æ•ˆï¼è«‹é‡æ–°é¸æ“‡ã€‚","error"),p.value=!1;return}const e=new FormData;e.append("file",o);try{const t=(await b.post(_,e,{timeout:12e4,headers:{"Content-Type":void 0}})).data;r(`âœ… ${t.message}`,"success"),V()}catch(l){const t=l.response?.data?.detail||l.message||"æœªçŸ¥éŒ¯èª¤";let x=`âŒ ä¸Šå‚³å¤±æ•—ï¼š${t}`;Array.isArray(t)&&(x="âŒ ä¸Šå‚³å¤±æ•—ï¼šä¼ºæœå™¨é©—è­‰éŒ¯èª¤ï¼Œè«‹æª¢æŸ¥æª”æ¡ˆæ ¼å¼ã€‚"),console.error("ä¸Šå‚³å¤±æ•—çš„éŒ¯èª¤ç‰©ä»¶:",l),r(x,"error")}finally{p.value=!1,n.value=null}}function r(o,e){y.value=o,w.value=e,f.value=!0}return(o,e)=>(D(),$(A,null,[a(z,{class:"mx-auto pa-4","max-width":"600",elevation:"10"},{default:s(()=>[a(g,{class:"text-h5 mb-2"},{default:s(()=>[...e[4]||(e[4]=[u("ðŸ’¾ Minecraft å­˜æª”ç®¡ç†",-1)])]),_:1}),a(L,null,{default:s(()=>[...e[5]||(e[5]=[u("ç›®æ¨™ç›®éŒ„ï¼šC:\\Users\\admin\\...\\saves",-1)])]),_:1}),a(S,null,{default:s(()=>[a(g,{class:"text-h6 mb-2 mt-4 pa-0"},{default:s(()=>[...e[6]||(e[6]=[u("ðŸ“¥ ä¸‹è¼‰ä¼ºæœå™¨å­˜æª”",-1)])]),_:1}),a(M,{modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=l=>i.value=l),items:c.value,label:"é¸æ“‡è¦ä¸‹è¼‰çš„å­˜æª”æª”æ¡ˆ (åŒ…å«å‰¯æª”å)",hint:"é»žæ“Šå³å´æŒ‰éˆ•é‡æ–°æ•´ç†æ¸…å–®","persistent-hint":"",variant:"outlined",density:"compact",clearable:"",loading:m.value,disabled:m.value,"item-title":"title","item-value":"value"},{"append-inner":s(()=>[a(v,{icon:"mdi-refresh",variant:"text",size:"small",onClick:V,loading:m.value,disabled:m.value},null,8,["loading","disabled"])]),_:1},8,["modelValue","items","loading","disabled"]),a(N,{class:"my-4"}),a(g,{class:"text-h6 mb-2 pa-0"},{default:s(()=>[...e[7]||(e[7]=[u("â¬†ï¸ ä¸Šå‚³æ–°å­˜æª”",-1)])]),_:1}),a(R,{modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=l=>n.value=l),label:"æ‹–æ›³æˆ–é»žæ“Šé¸æ“‡å­˜æª”æª”æ¡ˆ (.zip, è³‡æ–™å¤¾, .dat ç­‰)",hint:"åŒåæª”æ¡ˆå°‡åœ¨ä¼ºæœå™¨ç«¯è¢«è¦†è“‹","persistent-hint":"",variant:"outlined",density:"compact","prepend-icon":"mdi-cloud-upload","show-size":!0,counter:"",chips:"",clearable:"",disabled:p.value},null,8,["modelValue","disabled"])]),_:1}),a(I,{class:"d-flex justify-space-between"},{default:s(()=>[a(v,{color:"secondary",disabled:!i.value,onClick:C,"prepend-icon":"mdi-download",size:"large",variant:"tonal"},{default:s(()=>[...e[8]||(e[8]=[u(" ä¸‹è¼‰é¸å®šå­˜æª” ",-1)])]),_:1},8,["disabled"]),a(v,{color:"primary",disabled:!n.value||p.value,loading:p.value,onClick:F,"append-icon":"mdi-content-save",size:"large"},{default:s(()=>[...e[9]||(e[9]=[u(" ä¸Šå‚³ä¸¦å„²å­˜å­˜æª” ",-1)])]),_:1},8,["disabled","loading"])]),_:1})]),_:1}),a(B,{modelValue:f.value,"onUpdate:modelValue":e[3]||(e[3]=l=>f.value=l),timeout:3e3,color:w.value,location:"bottom right"},{actions:s(()=>[a(v,{color:"white",variant:"text",onClick:e[2]||(e[2]=l=>f.value=!1)},{default:s(()=>[...e[10]||(e[10]=[u(" é—œé–‰ ",-1)])]),_:1})]),default:s(()=>[u(T(y.value)+" ",1)]),_:1},8,["modelValue","color"])],64))}},pe=k(E,[["__scopeId","data-v-9ae101dc"]]);export{pe as default};
